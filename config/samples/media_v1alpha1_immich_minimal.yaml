apiVersion: media.rm3l.org/v1alpha1
kind: Immich
metadata:
  name: immich-minimal
spec:
  # Minimal configuration - requires:
  # 1. A PostgreSQL database
  # 2. A PVC for the photo library
  # 3. Image references for each enabled component

  # PostgreSQL database configuration (required)
  postgres:
    host: postgres
    passwordSecretRef:
      name: immich-postgres
      key: password

  # Photo library storage (required)
  immich:
    persistence:
      library:
        existingClaim: immich-library

  # Server component (required image)
  server:
    image:
      image: ghcr.io/immich-app/immich-server:v1.125.7

  # Machine Learning for smart search and face detection (required image)
  machineLearning:
    enabled: true
    image:
      image: ghcr.io/immich-app/immich-machine-learning:v1.125.7

  # Built-in Valkey for Redis (required image)
  valkey:
    enabled: true
    image:
      image: docker.io/valkey/valkey:8-alpine
